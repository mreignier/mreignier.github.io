<html>
<head>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
    google.charts.load('current', {'packages':['line', 'table']});
    //google.charts.setOnLoadCallback(drawChart);


    function drawChart() {
      document.getElementById('linechart_material').innerHTML = "loading ..."
      document.getElementById('table_div').innerHTML = ""

      var text= document.getElementById('word').value
      console.log(text)
      var queryString = encodeURIComponent('SELECT A, B, C, D, E WHERE F="'+ text +'"');
      var queryURL = 'https://docs.google.com/spreadsheets/d/1e1fQ4IDw6Z0em-8toyLOl2oXPGgiyK9dUStnDgWk1bs/edit?usp=sharing&tq=' + queryString
      console.log(queryURL)

      var query = new google.visualization.Query(queryURL);
      query.send(handleQueryResponse);

      var queryStringTable = encodeURIComponent('SELECT A, C WHERE B="'+ text +'"');
      var queryURLTable = 'https://docs.google.com/spreadsheets/d/100rgFnOxOLWqwQ42D8gRBTEDoUFSXO769R40VRS_X1w/edit?usp=sharing&tq=' + queryStringTable
      var queryTable = new google.visualization.Query(queryURLTable);
      queryTable.send(handleQueryResponseTable);

    }

    function handleQueryResponse(response) {
      var data = response.getDataTable();
      var text = document.getElementById('word').value

      console.log(text)
      var options = {
        chart: {
          title: 'Evolution of Social Scores',
          subtitle: text
        },
        width: 600,
        height: 250
      };

      var chart = new google.charts.Line(document.getElementById('linechart_material'));
      chart.draw(data, google.charts.Line.convertOptions(options));
    }

    function handleQueryResponseTable(response){
    var data = response.getDataTable();
    var options = {
      width: 300,
      height: 125
    };
    var table = new google.visualization.Table(document.getElementById('table_div'))
    table.draw(data);
  }

  </script>
  <script type="text/javascript">

  </script>
</head>
<body>
  <label for="word">Select a word to study</label>
  <input type="text" id="word" name="word" list="word-list">
  <button type="button" name="button" onclick="drawChart()">enter</button>
  <datalist id="word-list">
    <option value="aaa">
    <option value="aaa game">
    <option value="aaa games">
    <option value="aaa titles">
    <option value="aaaaaand">
    <option value="aaaaand">
    <option value="aaaand">
    <option value="aaah">
    <option value="aaand">
    <option value="aac">
    <option value="aah">
    <option value="aamc">
    <option value="aan">
    <option value="aang">
    <option value="aap">
    <option value="aaron">
    <option value="aaron rodgers">
    <option value="aaryn">
    <option value="aas">
    <option value="aba">
  </datalist>

<table class='columns'>
  <tr>
    <td><div id="linechart_material" style="border: 1px solid #ccc"></div></td>
    <td><div id="table_div" style="border: 1px solid #ccc"></div></td>
  </tr>
</body>
</html>
